---
title: "Shared mutations from the nf-resolveome genotyping output"
author: "Alexandra Tidd"
date: "`r format(Sys.time(), '%d %B, %Y')`"
output:
  html_document:
    fig_width: 8
    keep_md: true
    toc: true
    toc_float: true
    toc_collapsed: true
    toc_depth: 4
    theme: lumen
---

```{r setup, include = F}
# rmarkdown::render('reports/20250319_plot_shared_muts_from_nf-resolveome_dna.Rmd', output_file = '20250319_plot_shared_muts_from_nf-resolveome_dna.html', output_dir = 'reports/')

# chunk options
knitr::opts_knit$set(root.dir = "../")
knitr::opts_chunk$set(warning = FALSE,
                      dpi = 600,
                      message = FALSE)

# libraries
library(magrittr)
library(ggplot2)
```

We load the samplesheet.

```{r load_data}
man_insp <-
  readr::read_tsv("data/manual_inspection/2024-12-20_PD63118_PTA_BAF_LoH_CellType_Mut_Summary.tsv")
ss <- readr::read_csv("out/nf-resolveome/dna/samplesheet.csv") %>%
  dplyr::left_join(man_insp)
```

We load the variants.

```{r load_vars}
geno <-
  c("NV", "NR") %>%
  purrr::set_names() %>%
  purrr::map(function(type) {
    paste0("out/nf-resolveome/dna/PD63118/genotyping/", type,
           "_genotyped_mutations.tsv") %>%
      readr::read_tsv() %>%
      dplyr::distinct()
  })
```

We generate a heatmap of the mutations.

```{r plot_heatmap}

```